<div class="left-sidebar visible" id="sidebar">
  <a id="left-sidebar-btn" class="active" onclick="toggleSidebar(); return false;">
    <i class="fas fa-angle-left"></i>
  </a>
  {% assign sorted_tags = site.tags | sort %}
  {% for tag in sorted_tags %}
    {% assign t = tag | first %}
    {% assign posts = tag | last %}
    {% assign result = t | split: "." | last %}
    <a class="blog-tag-name inactive" id="{{ t }}-name" href="#" onclick="toggleTag('{{ t }}'); return false;">{{ result | upcase }}</a>
    <div class="blog-tag-list hidden" id="{{ t }}-list">
     {% for post in posts %}
       {% if post.tags contains t %}
         <li class="blog-tag-item" id="{{ t }}-item">
           <a class= "{{ t }}-post-title" href="{{ post.url }}">{{ post.title }}</a>
         </li>
       {% endif %}
     {% endfor %} 
    </div>
   {% endfor %}
   {% for t in page.tags %}
    <script>
      docReady(function() {
        if(window.innerWidth < 1200){
          var btn = document.getElementById("left-sidebar-btn");
          sidebar.setAttribute('class', "left-sidebar invisible");
          btn.innerHTML = "<i class='fas fa-angle-right'>";
          btn.setAttribute('class', 'inactive');
        }

        var tag = '{{ t }}';
        toggleTag(tag);

        var l = document.getElementsByClassName("{{ t }}-post-title");
        for(var i=0; i < l.length; i++) {
          if(l[i].innerHTML == "{{ page.title }}"){
            l[i].setAttribute('class', "{{ t }}-post-title active-post");
          }
        }
      });
      
      function docReady(fn) {
          // see if DOM is already available
          if (document.readyState === "complete" || document.readyState === "interactive") {
              // call on next available tick
              setTimeout(fn, 1);
          } else {
              document.addEventListener("DOMContentLoaded", fn);
          } 
      }
      </script>
   {% endfor %}
</div>
<script>
  function toggleSidebar(btn){
    var sidebar = document.getElementById("sidebar");
    var btn = document.getElementById("left-sidebar-btn");

    if(btn.classList.contains("active")){
      sidebar.setAttribute('class', "left-sidebar invisible");
      btn.innerHTML = "<i class='fas fa-angle-right'>";
      btn.setAttribute('class', 'inactive');
    }
    else{
      sidebar.setAttribute('class', "left-sidebar visible");
      btn.innerHTML = "<i class='fas fa-angle-left'>";
      btn.setAttribute('class', 'active');
    }
  }

  function toggleTag(tag) {
    var item = document.getElementById(tag + '-list');
    console.log(tag);
    if(item.classList.contains('hidden')) {
      document.getElementById(tag + '-name').setAttribute('class', 'blog-tag-name active');
      item.setAttribute('class', 'blog-tag-list active');
    }
    else{
      document.getElementById(tag + '-name').setAttribute('class', 'blog-tag-name inactive');
      item.setAttribute('class', 'blog-tag-list hidden');
    }

    var lists = document.getElementsByClassName('blog-tag-list');
    for(var i=0; i < lists.length; i++) {
      if(lists[i].id != tag + "-list"){
        lists[i].setAttribute('class', 'blog-tag-list hidden');
      }
    }

    var titles = document.getElementsByClassName('blog-tag-name');
    for(var i=0; i < titles.length; i++) {
      if(titles[i].id != tag + "-name"){
        titles[i].setAttribute('class', 'blog-tag-name inactive');
      }
    }
  }
</script>